<div class="-px-2 md:-px-3 tertiary-toolbar" *ngIf="army() != null && !loading()">

  <mat-toolbar>

    <h6 class="mb-0 text-truncate">{{army()!.name}}</h6>

    <button type="button" mat-icon-button matTooltip="Expand All" aria-label="Expand All" (click)="expandAll()" class="ml-auto">
        <mat-icon fontIcon="add_circle"></mat-icon>
    </button>

    <button type="button" mat-icon-button matTooltip="Collapse All" aria-label="Collapse All" (click)="collapseAll()">
      <mat-icon fontIcon="remove_circle"></mat-icon>
    </button>

    <button mat-button [matMenuTriggerFor]="menu">
      <mat-icon fontIcon="settings"></mat-icon>
      Settings
    </button>
    <mat-menu #menu="matMenu">
      <button type="button" mat-menu-item (click)="delete()">
        <mat-icon fontIcon="delete"></mat-icon>
        Delete Army
      </button>
    </mat-menu>

    <button type="button" mat-flat-button (click)="save()">
      <mat-icon fontIcon="save"></mat-icon>
      Save
    </button>

  </mat-toolbar>

</div>

<mat-progress-bar mode="indeterminate" *ngIf="loading()"></mat-progress-bar>

<div class="mt-3" *ngIf="!loading()">

  Unit Card - Commander

  <mat-accordion cdkDropList [cdkDropListData]="platoons()" (cdkDropListDropped)="drop($event)" [multi]="multiExpand()" #platoonAccordion>
    <mat-expansion-panel *ngFor="let platoon of platoons(); let i = index" cdkDrag #platoonPanel>
      <mat-expansion-panel-header class="ps-2">
        <mat-panel-title>
          <div class="drag-handle" cdkDragHandle>
            <mat-icon>drag_indicator</mat-icon>
          </div>
          {{ platoon.name }}
        </mat-panel-title>
        <mat-panel-description>
          {{ platoon.platoonName }}
        </mat-panel-description>
      </mat-expansion-panel-header>

      <!-- Load the PlatoonComponent for each platoon -->
      <app-platoon [platoon]="platoon"></app-platoon>

      <mat-action-row>
        <button mat-button (click)="deletePlatoon(i)">
          <mat-icon>delete</mat-icon>
          Delete Platoon
        </button>
      </mat-action-row>

    </mat-expansion-panel>

    <!-- Add Platoon Button -->
    <div class="mt-3">
      <button mat-flat-button color="primary" [matMenuTriggerFor]="addPlatoonMenu">
        + Add Platoon
      </button>

      <mat-menu #addPlatoonMenu="matMenu">
        <button mat-menu-item *ngFor="let platoon of platoonSelectors" (click)="addPlatoon(platoon)">
          {{ platoon.name }}
        </button>
      </mat-menu>

    </div>
  </mat-accordion>

</div>
